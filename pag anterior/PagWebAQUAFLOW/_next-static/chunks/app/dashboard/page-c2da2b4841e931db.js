(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{287:(e,s,t)=>{"use strict";t.d(s,{$:()=>d});var a=t(1215);t(5591);var r=t(5979),i=t(3736),n=t(411);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:s,variant:t,size:i,asChild:d=!1,...c}=e,o=d?r.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:(0,n.cn)(l({variant:t,size:i,className:s})),...c})}},1042:(e,s,t)=>{Promise.resolve().then(t.bind(t,7079))},1234:(e,s,t)=>{"use strict";t.d(s,{u:()=>d});var a=t(1215),r=t(411),i=t(5591),n=t(8511),l=t(3195);function d(e){var s,t,d;let{size:c="md"}=e,o=(0,n.C)(e=>e.user),x=null!==(s=null==o?void 0:o.litersSaved)&&void 0!==s?s:0,m=null!==(t=null==o?void 0:o.ownedDecor)&&void 0!==t?t:[],u=null!==(d=null==o?void 0:o.activeDecor)&&void 0!==d?d:[],h=(0,i.useMemo)(()=>[...l.N8].reverse().find(e=>x>=e.minLiters)||l.N8[0],[x]),p=(0,i.useMemo)(()=>u.length?l.Jg.filter(e=>u.includes(e.id)):l.Jg.filter(e=>m.includes(e.id)),[u,m]),f={background:"top-6 left-1/2 -translate-x-1/2 text-3xl opacity-80","surface-left":"top-8 left-6 text-2xl","surface-right":"top-8 right-6 text-2xl","mid-left":"top-1/2 left-5 -translate-y-1/2 text-3xl","mid-right":"top-1/2 right-5 -translate-y-1/2 text-3xl","floor-left":"bottom-6 left-6 text-3xl","floor-right":"bottom-6 right-6 text-3xl"};return(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 w-full",children:[(0,a.jsxs)("div",{className:(0,r.cn)("relative aspect-[4/3] w-full overflow-hidden rounded-3xl border border-primary/30 bg-gradient-to-b from-sky-100 via-sky-200 to-sky-300 shadow-inner",{sm:"max-w-[160px]",md:"max-w-[220px]",lg:"max-w-[280px]"}[c]),children:[(0,a.jsxs)("div",{className:"absolute inset-0",children:[(0,a.jsx)("div",{className:"absolute inset-x-4 bottom-4 h-1/2 rounded-3xl bg-gradient-to-t from-sky-500 via-sky-400/80 to-transparent"}),(0,a.jsx)("div",{className:"absolute inset-x-0 top-0 h-6 bg-white/40 blur-xl","aria-hidden":!0})]}),p.map(e=>(0,a.jsx)("span",{className:(0,r.cn)("absolute select-none transition-transform duration-500",f[e.slot]||"bottom-4 left-4"),"aria-label":e.name,children:e.icon},e.id)),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("span",{className:(0,r.cn)("animate-float transition-transform duration-500",{sm:"text-4xl",md:"text-6xl",lg:"text-7xl"}[c]),children:h.icon})}),(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-6 bg-white/30","aria-hidden":!0})]}),(0,a.jsxs)("div",{className:"text-center space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-primary",children:h.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground max-w-[240px] mx-auto",children:h.message})]})]})}},7079:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var a=t(1215),r=t(5591),i=t(3061),n=t(8511),l=t(411),d=t(9388),c=t(9414),o=t(2446),x=t(287),m=t(8475);let u=(0,m.A)("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]),h=(0,m.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),p=(0,m.A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),f=(0,m.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),v=(0,m.A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var g=t(2512),j=t.n(g),b=t(1234),y=t(3195);function N(){var e,s,t;let m=(0,i.useRouter)(),{user:g,getCurrentBadge:N}=(0,n.C)(),[w,k]=(0,r.useState)([]),[D,M]=(0,r.useState)(!1),[A,C]=(0,r.useState)(null),[T,E]=(0,r.useState)(0);(0,r.useEffect)(()=>{g||m.push("/")},[g,m]);let z=(0,r.useCallback)(async e=>{try{M(!0),C(null);let s=await fetch("https://9675658c5734.ngrok-free.app/api/Measurements",{headers:{accept:"text/plain","ngrok-skip-browser-warning":"true"},signal:e});if(!s.ok)throw Error("Error al obtener los sensores (".concat(s.status,")"));let t=await s.json();Array.isArray(t)?k(t.map(e=>{var s,t;return{id:String(e.id),value:Number(e.value),type:String(null!==(s=e.type)&&void 0!==s?s:""),date:String(null!==(t=e.date)&&void 0!==t?t:"")}})):k([])}catch(s){if((null==e?void 0:e.aborted)||s instanceof DOMException&&"AbortError"===s.name)return;C(s instanceof Error?s.message:"No pudimos cargar la informaci\xf3n de sensores")}finally{(null==e?void 0:e.aborted)||M(!1)}},[]);(0,r.useEffect)(()=>{if(!g)return;let e=new AbortController;return z(e.signal),()=>{e.abort()}},[g,z]);let B=(0,r.useMemo)(()=>w.slice().sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()),[w]),S=(0,r.useMemo)(()=>{let e=5*T;return B.slice(e,e+5)},[B,T]),Z=(0,r.useMemo)(()=>B.length?Number((B.reduce((e,s)=>e+(Number.isFinite(s.value)?s.value:0),0)/B.length).toFixed(1)):null,[B]),L=null!==(s=null===(e=B[0])||void 0===e?void 0:e.type)&&void 0!==s?s:"L/M",_=Math.max(1,Math.ceil(B.length/5));(0,r.useEffect)(()=>{E(0)},[B]);let F=e=>{let s=new Date(e);return Number.isNaN(s.getTime())?e:new Intl.DateTimeFormat("es-PE",{day:"2-digit",month:"short",year:"numeric"}).format(s)};if(!g)return null;let R=N(),$=null!==(t=g.coins)&&void 0!==t?t:0;return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)(d.Y,{}),(0,a.jsxs)("main",{className:"flex-1 container py-8",children:[(0,a.jsxs)("div",{className:"mb-8 animate-in fade-in slide-in-from-bottom duration-500",children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold text-primary mb-2",children:["\xa1Hola, ",g.name,"! \uD83D\uDC4B"]}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground",children:"Bienvenido a tu centro de comando del agua"})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)(j(),{href:"/games",className:"group",children:(0,a.jsxs)(o.Zp,{className:"h-full transition-all duration-300 hover:shadow-xl hover:-translate-y-1 border-2 hover:border-primary cursor-pointer",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-primary/10 group-hover:bg-primary/20 transition-colors",children:(0,a.jsx)(u,{className:"h-8 w-8 text-primary"})}),(0,a.jsx)("span",{className:"text-3xl",children:"\uD83C\uDFAF"})]}),(0,a.jsx)(o.ZB,{className:"text-2xl",children:"Desaf\xedos Interactivos"}),(0,a.jsx)(o.BT,{children:"Aprende jugando con nuestros 3 juegos educativos"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCA7"}),(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDDE0"}),(0,a.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF31"})]}),(0,a.jsx)(x.$,{className:"w-full",variant:"default",children:"Jugar ahora"})]})]})}),(0,a.jsx)(j(),{href:"/profile",className:"group",children:(0,a.jsxs)(o.Zp,{className:"h-full transition-all duration-300 hover:shadow-xl hover:-translate-y-1 border-2 hover:border-secondary cursor-pointer",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-secondary/10 group-hover:bg-secondary/20 transition-colors",children:(0,a.jsx)(h,{className:"h-8 w-8 text-secondary"})}),(0,a.jsx)("span",{className:"text-3xl",children:R.icon})]}),(0,a.jsx)(o.ZB,{className:"text-2xl",children:"Perfil de H\xe9roe"}),(0,a.jsx)(o.BT,{children:"Tu progreso y logros en la conservaci\xf3n del agua"})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Litros ahorrados"}),(0,a.jsxs)("span",{className:"text-xl font-bold text-primary",children:[g.litersSaved,"L"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Nivel actual"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:R.name})]})]}),(0,a.jsx)(x.$,{className:"w-full",variant:"secondary",children:"Ver perfil"})]})]})}),(0,a.jsxs)(o.Zp,{className:"h-full transition-all duration-300 hover:shadow-xl hover:-translate-y-1 border-2 hover:border-accent",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-accent/10",children:(0,a.jsx)(p,{className:"h-8 w-8 text-accent"})}),(0,a.jsx)("span",{className:"text-3xl",children:"\uD83C\uDF0E"})]}),(0,a.jsx)(o.ZB,{className:"text-2xl",children:"Datos de Tacna"}),(0,a.jsx)(o.BT,{children:"Informaci\xf3n clave sobre el agua en nuestra regi\xf3n"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-muted",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Consumo promedio"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"180L por persona/d\xeda"})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-muted",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Precipitaci\xf3n anual"}),(0,a.jsxs)("p",{className:"text-sm font-medium",children:["<"," 50mm (muy \xe1rido)"]})]})]})})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-6",children:[(0,a.jsxs)(o.Zp,{className:"animate-in fade-in slide-in-from-left duration-700",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Conoce a Tito \uD83D\uDC20"}),(0,a.jsx)(o.BT,{children:"Tu compa\xf1ero en esta aventura"})]}),(0,a.jsxs)(o.Wu,{className:"flex flex-col items-center gap-4 py-8",children:[(0,a.jsx)(b.u,{size:"lg"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground text-center",children:["Tienes ",(0,a.jsxs)("span",{className:"font-semibold text-primary",children:[$," \uD83E\uDE99"]})," para decorar la pecera de Tito."]}),(0,a.jsx)(j(),{href:"/profile",children:(0,a.jsx)(x.$,{size:"sm",variant:"secondary",children:"Abrir tienda"})})]})]}),(0,a.jsxs)(o.Zp,{className:"animate-in fade-in slide-in-from-right duration-700",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"\xbfSab\xedas que...?"}),(0,a.jsx)(o.BT,{children:"Datos importantes sobre el agua en Tacna"})]}),(0,a.jsx)(o.Wu,{className:"space-y-4",children:y.Bc.map((e,s)=>(0,a.jsxs)("div",{className:"flex gap-3 p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},s))})]}),(0,a.jsxs)(o.Zp,{className:"animate-in fade-in slide-in-from-bottom duration-700",children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.ZB,{children:"Sensores en tiempo real"}),(0,a.jsx)(o.BT,{children:"Mediciones recientes de consumo"})]}),(0,a.jsx)(x.$,{size:"icon",variant:"ghost",onClick:()=>{z()},disabled:D,"aria-label":"Actualizar sensores",children:(0,a.jsx)(f,{className:(0,l.cn)("h-4 w-4",D&&"animate-spin")})})]})}),(0,a.jsxs)(o.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-primary/20 bg-primary/5 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Promedio registrado"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-primary",children:null!==Z?"".concat(Z," ").concat(L):"â€”"})]}),(0,a.jsx)(v,{className:"h-8 w-8 text-primary"})]}),A&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:A}),!A&&D&&(0,a.jsx)("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"h-10 rounded-md bg-muted animate-pulse"},e))}),!D&&!A&&0===B.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay mediciones disponibles en este momento."}),!D&&!A&&B.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"space-y-2",children:S.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-md bg-muted/60 px-3 py-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-primary",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:F(e.date)})]}),(0,a.jsx)("span",{className:"text-xs font-semibold uppercase text-muted-foreground",children:e.type})]},e.id))}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["P\xe1gina ",T+1," de ",_]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.$,{size:"sm",variant:"outline",onClick:()=>{E(e=>Math.max(0,e-1))},disabled:0===T,children:"Anterior"}),(0,a.jsx)(x.$,{size:"sm",variant:"outline",onClick:()=>{E(e=>Math.min(_-1,e+1))},disabled:T>=_-1,children:"Siguiente"})]})]})]})]})]})]})]}),(0,a.jsx)(c.w,{})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[784,505,62,403,874,358],()=>s(1042)),_N_E=e.O()}]);